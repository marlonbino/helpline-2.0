<div class="sidebar">
    <div class="logo">Helpline 2.0</div>
    
    <!-- Main Operations Section -->
    <div class="nav-section">
        <div class="nav-title">Operations</div>
        
        <!-- Main Dashboard -->
        <a href="/dashboard" class="nav-item{% if request.path == '/dashboard' %} active{% endif %}" data-filename="dashboard" onclick="handleDashboardClick(event)">
            <div class="nav-icon">üìä</div>
            <span>Main Dashboard</span>
        </a>
        
        <!-- Call Data Section -->
        <a href="#callDataSubmenu" class="nav-item dropdown-toggle{% if request.path == '/call-data' %} active{% endif %}" data-bs-toggle="collapse" aria-expanded="false">
            <div class="nav-icon">üìû</div>
            <span>Call Data</span>
        </a>
        <div class="collapse" id="callDataSubmenu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/call-data" class="nav-link sub-item py-1{% if request.path == '/call-data' %} active{% endif %}" data-filename="call_data">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- Case Data Section -->
        <a href="#caseDataSubmenu" class="nav-item dropdown-toggle{% if request.path == '/case-data' %} active{% endif %}" data-bs-toggle="collapse" aria-expanded="false">
            <div class="nav-icon">üìã</div>
            <span>Case Data</span>
        </a>
        <div class="collapse" id="caseDataSubmenu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/case-data" class="nav-link sub-item py-1{% if request.path == '/case-data' %} active{% endif %}" data-filename="case_data">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- AI Services Section -->
        <a href="#aiServicesSubmenu" class="nav-item dropdown-toggle{% if request.path == '/ai-services' %} active{% endif %}" data-bs-toggle="collapse" aria-expanded="false">
            <div class="nav-icon">ü§ñ</div>
            <span>AI Services</span>
        </a>
        <div class="collapse" id="aiServicesSubmenu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/ai-services" class="nav-link sub-item py-1{% if request.path == '/ai-services' %} active{% endif %}" data-filename="ai_services">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- Users and Roles Section -->
        <a href="#usersRolesSubmenu" class="nav-item dropdown-toggle{% if request.path == '/users-roles' %} active{% endif %}" data-bs-toggle="collapse" aria-expanded="false">
            <div class="nav-icon">üë•</div>
            <span>Users & Roles</span>
        </a>
        <div class="collapse" id="usersRolesSubmenu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/users-roles" class="nav-link sub-item py-1{% if request.path == '/users-roles' %} active{% endif %}" data-filename="users_roles">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Contacts Section -->
        <a href="#contactsSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
            <div class="nav-icon">üë•</div>
            <span>Contacts</span>
        </a>
        <div class="collapse" id="contactsSubmenu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/contacts" class="nav-link sub-item py-1" data-filename="contacts">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>

    </div>

    <!-- Resources Section -->
    <div class="nav-section">
        <div class="nav-title">Resources</div>
        
        <!-- System Services Section -->
        <a href="#systemServicesSubmenu" class="nav-item dropdown-toggle{% if request.path == '/system-services' %} active{% endif %}" data-bs-toggle="collapse" aria-expanded="false">
            <div class="nav-icon">‚öôÔ∏è</div>
            <span>System Services</span>
        </a>
        <div class="collapse" id="systemServicesSubmenu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/system-services" class="nav-link sub-item py-1{% if request.path == '/system-services' %} active{% endif %}">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Chatbot Section -->
        <a href="#chatbotSubmenu" class="nav-item dropdown-toggle{% if request.path == '/chatbot' %} active{% endif %}" data-bs-toggle="collapse" aria-expanded="false">
            <div class="nav-icon">ü§ñ</div>
            <span>Chatbot</span>
        </a>
        <div class="collapse" id="chatbotSubmenu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/chatbot" class="nav-link sub-item py-1{% if request.path == '/chatbot' %} active{% endif %}" data-filename="chatbot">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Documentation Section -->
        <a href="#documentationSubmenu" class="nav-item dropdown-toggle{% if request.path == '/documentation' %} active{% endif %}" data-bs-toggle="collapse" aria-expanded="false">
            <div class="nav-icon">üìö</div>
            <span>Documentation</span>
        </a>
        <div class="collapse" id="documentationSubmenu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="/documentation" class="nav-link sub-item py-1{% if request.path == '/documentation' %} active{% endif %}" data-filename="documentation">
                        <div class="nav-icon">üìä</div>
                        <span>Dashboard</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Profile Section -->
    <div class="profile-section">
        <div class="profile-avatar"></div>
        <div class="profile-info">
            <div class="profile-name">Marlon</div>
            <div class="profile-status">Counselor</div>
        </div>
    </div>
</div>

<script>
// JavaScript to handle dynamic data loading
document.addEventListener('DOMContentLoaded', function() {
    // Handle all data links
    document.querySelectorAll('[data-filename]').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const filename = this.getAttribute('data-filename');
            loadDataContent(filename);
        });
    });
});

// Special handler for dashboard button
function handleDashboardClick(event) {
    event.preventDefault();
    const filename = event.target.closest('a').getAttribute('data-filename');
    
    // For dashboard, we can either load data dynamically or navigate to the route
    // Let's try the dynamic approach first
    loadDataContent(filename);
    
    // Update URL to show dashboard
    window.history.pushState({}, '', '/dashboard');
}

function loadDataContent(filename) {
    // Show loading state
    const mainContent = document.querySelector('.main-content');
    if (mainContent) {
        mainContent.innerHTML = '<div class="loading">Loading...</div>';
    }
    
    // Make AJAX request to load data
    fetch('/data/' + filename, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            next: false,
            prev: false
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.error) {
            console.error('Error loading data:', data.error);
            mainContent.innerHTML = '<div class="error">Error loading content: ' + data.error + '</div>';
        } else {
            // Update URL without page reload
            window.history.pushState({}, '', '/data/' + filename);
            
            // Update active states
            updateActiveStates(filename);
            
            // Render the content
            renderContent(data, filename);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        // If dynamic loading fails, try to navigate to the regular route
        if (filename === 'dashboard') {
            window.location.href = '/dashboard';
        } else {
            mainContent.innerHTML = '<div class="error">Error loading content</div>';
        }
    });
}

function updateActiveStates(filename) {
    // Remove all active classes
    document.querySelectorAll('.nav-item, .nav-link').forEach(item => {
        item.classList.remove('active');
    });
    
    // Add active class to current item
    const activeLink = document.querySelector(`[data-filename="${filename}"]`);
    if (activeLink) {
        activeLink.classList.add('active');
        
        // If it's a sub-item, also activate the parent dropdown
        const parentDropdown = activeLink.closest('.collapse');
        if (parentDropdown) {
            parentDropdown.classList.add('show');
        }
    }
}

function renderContent(data, filename) {
    const mainContent = document.querySelector('.main-content');
    if (!mainContent) return;
    
    // Render content based on filename
    switch(filename) {
        case 'dashboard':
            renderDashboard(data);
            break;
        case 'call_data':
            renderCallData(data);
            break;
        case 'case_data':
            renderCaseData(data);
            break;
        case 'ai_services':
            renderAIServices(data);
            break;
        case 'users_roles':
            renderUsersRoles(data);
            break;
        case 'contacts':
            renderContacts(data);
            break;
        case 'chatbot':
            renderChatbot(data);
            break;
        case 'documentation':
            renderDocumentation(data);
            break;
        default:
            renderGenericContent(data, filename);
    }
}

// Content rendering functions (you can customize these)
function renderDashboard(data) {
    const mainContent = document.querySelector('.main-content');
    const overview = data.data.overview;
    const quickStats = data.data.quick_stats;
    
    mainContent.innerHTML = `
        <div class="header">
            <div class="header-left">
                <h1>Main Dashboard</h1>
                <div class="header-subtitle">Real-time overview of helpline operations</div>
            </div>
        </div>
        <div class="dashboard-content">
            <div class="row">
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üìû</div>
                        <div class="metric-value">${overview.total_calls}</div>
                        <div class="metric-label">Total Calls</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üìÅ</div>
                        <div class="metric-value">${overview.total_cases}</div>
                        <div class="metric-label">Total Cases</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üë•</div>
                        <div class="metric-value">${overview.active_users}</div>
                        <div class="metric-label">Active Users</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">‚úÖ</div>
                        <div class="metric-value">${overview.system_health}</div>
                        <div class="metric-label">System Health</div>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5>Quick Stats</h5>
                        </div>
                        <div class="card-body">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between">
                                    <span>Calls Today</span>
                                    <span class="badge bg-primary">${quickStats.calls_today}</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between">
                                    <span>Cases Resolved</span>
                                    <span class="badge bg-success">${quickStats.cases_resolved}</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between">
                                    <span>New Contacts</span>
                                    <span class="badge bg-info">${quickStats.new_contacts}</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between">
                                    <span>AI Requests</span>
                                    <span class="badge bg-warning">${quickStats.ai_requests}</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5>System Status</h5>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-success">
                                <strong>All systems operational</strong><br>
                                Last updated: ${new Date().toLocaleString()}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function renderCallData(data) {
    const mainContent = document.querySelector('.main-content');
    const callData = data.data;
    
    mainContent.innerHTML = `
        <div class="header">
            <div class="header-left">
                <h1>Call Data Dashboard</h1>
                <div class="header-subtitle">Monitor and analyze call center performance</div>
            </div>
        </div>
        <div class="dashboard-content">
            <div class="row">
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üìû</div>
                        <div class="metric-value">${callData.total_calls}</div>
                        <div class="metric-label">Total Calls</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üîÑ</div>
                        <div class="metric-value">${callData.active_calls}</div>
                        <div class="metric-label">Active Calls</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">‚è±Ô∏è</div>
                        <div class="metric-value">${callData.avg_duration}</div>
                        <div class="metric-label">Avg Duration</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üòä</div>
                        <div class="metric-value">${callData.satisfaction_rate}%</div>
                        <div class="metric-label">Satisfaction</div>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5>Recent Calls</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Call ID</th>
                                            <th>Duration</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${callData.recent_calls.map(call => `
                                            <tr>
                                                <td>${call.id}</td>
                                                <td>${call.duration}</td>
                                                <td><span class="badge bg-${call.status === 'completed' ? 'success' : 'warning'}">${call.status}</span></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5>Call Statistics</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="callChart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Initialize chart
    setTimeout(() => {
        const ctx = document.getElementById('callChart');
        if (ctx) {
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Completed', 'Active', 'Missed'],
                    datasets: [{
                        data: [callData.total_calls - callData.active_calls, callData.active_calls, 5],
                        backgroundColor: ['#28a745', '#ffc107', '#dc3545']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
    }, 100);
}

function renderCaseData(data) {
    const mainContent = document.querySelector('.main-content');
    const caseData = data.data;
    
    mainContent.innerHTML = `
        <div class="header">
            <div class="header-left">
                <h1>Case Data Dashboard</h1>
                <div class="header-subtitle">Manage and track case information</div>
            </div>
        </div>
        <div class="dashboard-content">
            <div class="row">
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üìÅ</div>
                        <div class="metric-value">${caseData.total_cases}</div>
                        <div class="metric-label">Total Cases</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üîì</div>
                        <div class="metric-value">${caseData.open_cases}</div>
                        <div class="metric-label">Open Cases</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">‚úÖ</div>
                        <div class="metric-value">${caseData.resolved_cases}</div>
                        <div class="metric-label">Resolved Cases</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">‚è±Ô∏è</div>
                        <div class="metric-value">${caseData.avg_resolution_time}</div>
                        <div class="metric-label">Avg Resolution</div>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5>Recent Cases</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Case ID</th>
                                            <th>Priority</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${caseData.recent_cases.map(case_item => `
                                            <tr>
                                                <td>${case_item.id}</td>
                                                <td><span class="badge bg-${case_item.priority === 'High' ? 'danger' : case_item.priority === 'Medium' ? 'warning' : 'success'}">${case_item.priority}</span></td>
                                                <td><span class="badge bg-${case_item.status === 'Open' ? 'danger' : case_item.status === 'In Progress' ? 'warning' : 'success'}">${case_item.status}</span></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5>Case Status</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="caseChart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Initialize chart
    setTimeout(() => {
        const ctx = document.getElementById('caseChart');
        if (ctx) {
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Open', 'In Progress', 'Resolved'],
                    datasets: [{
                        data: [caseData.open_cases, 50, caseData.resolved_cases],
                        backgroundColor: ['#dc3545', '#ffc107', '#28a745']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
    }, 100);
}

function renderAIServices(data) {
    const mainContent = document.querySelector('.main-content');
    const aiData = data.data;
    
    mainContent.innerHTML = `
        <div class="header">
            <div class="header-left">
                <h1>AI Services Dashboard</h1>
                <div class="header-subtitle">Monitor and manage AI-powered services in real-time</div>
            </div>
            <div class="header-right">
                <button class="btn btn-primary" onclick="openServiceConfig()">
                    <i class="fas fa-cog"></i> Configure Services
                </button>
                <button class="btn btn-outline-primary" onclick="exportAIData()">
                    <i class="fas fa-download"></i> Export Data
                </button>
            </div>
        </div>

        <!-- Quick Actions Bar -->
        <div class="quick-actions">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="serviceSearch" placeholder="Search services...">
            </div>
            <div class="filter-group">
                <select id="serviceTypeFilter" class="filter-select">
                    <option value="">All Services</option>
                    <option value="transcription">Transcription</option>
                    <option value="translation">Translation</option>
                    <option value="classification">Classification</option>
                    <option value="analytics">Analytics</option>
                </select>
                <select id="statusFilter" class="filter-select">
                    <option value="">All Statuses</option>
                    <option value="active">Active</option>
                    <option value="idle">Idle</option>
                    <option value="error">Error</option>
                    <option value="maintenance">Maintenance</option>
                </select>
                <select id="timeFilter" class="filter-select">
                    <option value="today">Today</option>
                    <option value="week">This Week</option>
                    <option value="month">This Month</option>
                    <option value="quarter">This Quarter</option>
                    <option value="year">This Year</option>
                </select>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üé§</div>
                <div class="stat-label">Total Transcriptions</div>
                <div class="stat-value" id="totalTranscriptions">${aiData.total_requests || '1,234'}</div>
                <div class="stat-change stat-positive">‚Üó +12.3%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Success Rate:</span>
                    <span class="stat-footer-value" id="transcriptionSuccessRate">${aiData.success_rate || '98.5'}%</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üåê</div>
                <div class="stat-label">Translation Volume</div>
                <div class="stat-value" id="translationVolume">856</div>
                <div class="stat-change stat-positive">‚Üó +8.2%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Languages:</span>
                    <span class="stat-footer-value" id="supportedLanguages">12</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üè∑Ô∏è</div>
                <div class="stat-label">Classification Accuracy</div>
                <div class="stat-value" id="classificationAccuracy">95.2%</div>
                <div class="stat-change stat-positive">‚Üó +2.1%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Categories:</span>
                    <span class="stat-footer-value" id="totalCategories">24</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚ö°</div>
                <div class="stat-label">Average Response Time</div>
                <div class="stat-value" id="avgResponseTime">${aiData.avg_response_time || '0.8s'}</div>
                <div class="stat-change stat-positive">‚Üì -15%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Peak Load:</span>
                    <span class="stat-footer-value" id="peakLoad">75%</span>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Service Performance -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Service Performance</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshPerformanceChart()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="btn btn-link" onclick="togglePerformanceView()">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Service Distribution -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Service Distribution</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshDistributionChart()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="distributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Service Health -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Service Health</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshHealthStatus()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="health-status">
                        <div class="health-item">
                            <div class="health-icon transcription">üé§</div>
                            <div class="health-info">
                                <div class="health-title">Transcription Service</div>
                                <div class="health-metrics">
                                    <span class="health-status-badge active">Active</span>
                                    <span class="health-uptime">99.9% Uptime</span>
                                </div>
                            </div>
                        </div>
                        <div class="health-item">
                            <div class="health-icon translation">üåê</div>
                            <div class="health-info">
                                <div class="health-title">Translation Service</div>
                                <div class="health-metrics">
                                    <span class="health-status-badge active">Active</span>
                                    <span class="health-uptime">99.8% Uptime</span>
                                </div>
                            </div>
                        </div>
                        <div class="health-item">
                            <div class="health-icon classification">üè∑Ô∏è</div>
                            <div class="health-info">
                                <div class="health-title">Classification Service</div>
                                <div class="health-metrics">
                                    <span class="health-status-badge active">Active</span>
                                    <span class="health-uptime">99.7% Uptime</span>
                                </div>
                            </div>
                        </div>
                        <div class="health-item">
                            <div class="health-icon analytics">üìä</div>
                            <div class="health-info">
                                <div class="health-title">Analytics Service</div>
                                <div class="health-metrics">
                                    <span class="health-status-badge active">Active</span>
                                    <span class="health-uptime">99.6% Uptime</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Recent Activity</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshActivity()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="activity-list" id="activityList">
                        <div class="activity-item">
                            <div class="activity-icon">üé§</div>
                            <div class="activity-content">
                                <div class="activity-title">Transcription</div>
                                <div class="activity-description">Completed batch processing</div>
                                <div class="activity-time">2 minutes ago</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">üåê</div>
                            <div class="activity-content">
                                <div class="activity-title">Translation</div>
                                <div class="activity-description">Updated language models</div>
                                <div class="activity-time">15 minutes ago</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">üè∑Ô∏è</div>
                            <div class="activity-content">
                                <div class="activity-title">Classification</div>
                                <div class="activity-description">Improved accuracy by 2.1%</div>
                                <div class="activity-time">1 hour ago</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">üìä</div>
                            <div class="activity-content">
                                <div class="activity-title">Analytics</div>
                                <div class="activity-description">Generated monthly report</div>
                                <div class="activity-time">2 hours ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Service Table -->
        <div class="table-section">
            <div class="table-header">
                <h3>Service Details</h3>
                <div class="table-actions">
                    <button class="btn btn-link" onclick="refreshTable()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <button class="btn btn-link" onclick="toggleColumns()">
                        <i class="fas fa-columns"></i> Columns
                    </button>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table" id="serviceTable">
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Status</th>
                            <th>Requests</th>
                            <th>Success Rate</th>
                            <th>Response Time</th>
                            <th>Last Updated</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Transcription Service</td>
                            <td><span class="status-badge active">active</span></td>
                            <td>1,234</td>
                            <td>98.5%</td>
                            <td>0.5s</td>
                            <td>2 min ago</td>
                            <td>
                                <div class="table-actions">
                                    <button class="action-btn" onclick="viewServiceDetails('Transcription Service')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="editService('Transcription Service')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Translation Service</td>
                            <td><span class="status-badge active">active</span></td>
                            <td>856</td>
                            <td>97.8%</td>
                            <td>0.8s</td>
                            <td>5 min ago</td>
                            <td>
                                <div class="table-actions">
                                    <button class="action-btn" onclick="viewServiceDetails('Translation Service')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="editService('Translation Service')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Classification Service</td>
                            <td><span class="status-badge active">active</span></td>
                            <td>2,345</td>
                            <td>95.2%</td>
                            <td>0.3s</td>
                            <td>1 min ago</td>
                            <td>
                                <div class="table-actions">
                                    <button class="action-btn" onclick="viewServiceDetails('Classification Service')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="editService('Classification Service')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Analytics Service</td>
                            <td><span class="status-badge active">active</span></td>
                            <td>567</td>
                            <td>99.1%</td>
                            <td>1.2s</td>
                            <td>10 min ago</td>
                            <td>
                                <div class="table-actions">
                                    <button class="action-btn" onclick="viewServiceDetails('Analytics Service')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="editService('Analytics Service')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    `;
    
    // Initialize charts after content is loaded
    setTimeout(() => {
        initializeAIServiceCharts();
    }, 100);
}

// Function to initialize AI Service charts
function initializeAIServiceCharts() {
    // Performance Chart
    const performanceCtx = document.getElementById('performanceChart');
    if (performanceCtx) {
        new Chart(performanceCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [
                    {
                        label: 'Transcription',
                        data: [120, 150, 180, 200, 220, 250],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Translation',
                        data: [80, 100, 120, 140, 160, 180],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Classification',
                        data: [60, 75, 90, 105, 120, 135],
                        borderColor: '#f59e0b',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            }
        });
    }

    // Distribution Chart
    const distributionCtx = document.getElementById('distributionChart');
    if (distributionCtx) {
        new Chart(distributionCtx, {
            type: 'doughnut',
            data: {
                labels: ['Transcription', 'Translation', 'Classification', 'Analytics'],
                datasets: [{
                    data: [40, 25, 20, 15],
                    backgroundColor: [
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(245, 158, 11, 0.8)',
                        'rgba(99, 102, 241, 0.8)'
                    ],
                    borderColor: [
                        'rgba(59, 130, 246, 1)',
                        'rgba(16, 185, 129, 1)',
                        'rgba(245, 158, 11, 1)',
                        'rgba(99, 102, 241, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            usePointStyle: true,
                            padding: 20
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.raw || 0;
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${label}: ${value} (${percentage}%)`;
                            }
                        }
                    }
                },
                cutout: '60%'
            }
        });
    }
}

function renderUsersRoles(data) {
    const mainContent = document.querySelector('.main-content');
    const userData = data.data;
    
    mainContent.innerHTML = `
        <div class="header">
            <div class="header-left">
                <h1>Users & Roles Dashboard</h1>
                <div class="header-subtitle">Manage users and permissions</div>
            </div>
        </div>
        <div class="dashboard-content">
            <div class="row">
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üë•</div>
                        <div class="metric-value">${userData.total_users}</div>
                        <div class="metric-label">Total Users</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üü¢</div>
                        <div class="metric-value">${userData.active_users}</div>
                        <div class="metric-label">Active Users</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üîê</div>
                        <div class="metric-value">${userData.total_roles}</div>
                        <div class="metric-label">Total Roles</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-icon">üìä</div>
                        <div class="metric-value">${Math.round((userData.active_users / userData.total_users) * 100)}%</div>
                        <div class="metric-label">Active Rate</div>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5>Recent Activity</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>User</th>
                                            <th>Action</th>
                                            <th>Time</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${userData.recent_activity.map(activity => `
                                            <tr>
                                                <td>${activity.user}</td>
                                                <td><span class="badge bg-info">${activity.action}</span></td>
                                                <td>${activity.time}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5>User Status</h5>
                        </div>
                        <div class="card-body">
                            <canvas id="userChart" width="300" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Initialize chart
    setTimeout(() => {
        const ctx = document.getElementById('userChart');
        if (ctx) {
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Active Users', 'Inactive Users'],
                    datasets: [{
                        data: [userData.active_users, userData.total_users - userData.active_users],
                        backgroundColor: ['#28a745', '#6c757d']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
    }, 100);
}

function renderContacts(data) {
    const mainContent = document.querySelector('.main-content');
    const contactData = data.data;
    
    mainContent.innerHTML = `
        <div class="header">
            <div class="header-left">
                <h1>Contacts Dashboard</h1>
                <div class="header-subtitle">Manage and track all contact information</div>
            </div>
            <div class="header-right">
                <button class="btn btn-primary" onclick="addNewContact()">
                    <i class="fas fa-plus"></i> Add Contact
                </button>
                <button class="btn btn-outline-primary" onclick="exportContacts()">
                    <i class="fas fa-download"></i> Export
                </button>
            </div>
        </div>

        <!-- Quick Actions Bar -->
        <div class="quick-actions">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="contactSearch" placeholder="Search contacts...">
            </div>
            <div class="filter-group">
                <select id="contactTypeFilter" class="filter-select">
                    <option value="">All Types</option>
                    <option value="client">Client</option>
                    <option value="partner">Partner</option>
                    <option value="vendor">Vendor</option>
                    <option value="internal">Internal</option>
                </select>
                <select id="statusFilter" class="filter-select">
                    <option value="">All Status</option>
                    <option value="active">Active</option>
                    <option value="inactive">Inactive</option>
                </select>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-label">Total Contacts</div>
                <div class="stat-value">${contactData.total_contacts}</div>
                <div class="stat-change stat-positive">‚Üó +5.2%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Active:</span>
                    <span class="stat-footer-value">${contactData.active_contacts}</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üÜï</div>
                <div class="stat-label">New This Month</div>
                <div class="stat-value">${contactData.recent_contacts}</div>
                <div class="stat-change stat-positive">‚Üó +12.8%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Growth:</span>
                    <span class="stat-footer-value">+8.3%</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-label">Contact Types</div>
                <div class="stat-value">${Object.keys(contactData.contact_types).length}</div>
                <div class="stat-change stat-positive">‚Üó +2</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Most Common:</span>
                    <span class="stat-footer-value">Client</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-label">Interaction Rate</div>
                <div class="stat-value">78%</div>
                <div class="stat-change stat-positive">‚Üó +3.1%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Avg per Contact:</span>
                    <span class="stat-footer-value">2.4</span>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Contact Distribution -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Contact Distribution</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshDistributionChart()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="contactDistributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Contact Growth -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Contact Growth</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshGrowthChart()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="contactGrowthChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Recent Activity</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshActivity()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="activity-list">
                        ${contactData.recent_activity.map(activity => `
                            <div class="activity-item">
                                <div class="activity-icon">üë§</div>
                                <div class="activity-content">
                                    <div class="activity-title">${activity.contact}</div>
                                    <div class="activity-description">${activity.action}</div>
                                    <div class="activity-time">${activity.time}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>

            <!-- Contact Types Breakdown -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Contact Types</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshTypesBreakdown()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="types-breakdown">
                        ${Object.entries(contactData.contact_types).map(([type, count]) => `
                            <div class="type-item">
                                <div class="type-info">
                                    <div class="type-name">${type}</div>
                                    <div class="type-count">${count} contacts</div>
                                </div>
                                <div class="type-percentage">${Math.round((count / contactData.total_contacts) * 100)}%</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        </div>

        <!-- Contacts Table -->
        <div class="table-section">
            <div class="table-header">
                <h3>All Contacts</h3>
                <div class="table-actions">
                    <button class="btn btn-link" onclick="refreshTable()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <button class="btn btn-link" onclick="exportTable()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table" id="contactTable">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Type</th>
                            <th>Status</th>
                            <th>Last Contact</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>John Smith</td>
                            <td>john@example.com</td>
                            <td>+1234567890</td>
                            <td><span class="category-badge client">Client</span></td>
                            <td><span class="status-badge active">Active</span></td>
                            <td>2 hours ago</td>
                            <td>
                                <div class="table-actions">
                                    <button class="action-btn" onclick="viewContact('john-smith')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="editContact('john-smith')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Jane Doe</td>
                            <td>jane@example.com</td>
                            <td>+1234567891</td>
                            <td><span class="category-badge partner">Partner</span></td>
                            <td><span class="status-badge active">Active</span></td>
                            <td>1 day ago</td>
                            <td>
                                <div class="table-actions">
                                    <button class="action-btn" onclick="viewContact('jane-doe')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="editContact('jane-doe')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Bob Wilson</td>
                            <td>bob@example.com</td>
                            <td>+1234567892</td>
                            <td><span class="category-badge vendor">Vendor</span></td>
                            <td><span class="status-badge active">Active</span></td>
                            <td>3 days ago</td>
                            <td>
                                <div class="table-actions">
                                    <button class="action-btn" onclick="viewContact('bob-wilson')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="editContact('bob-wilson')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    `;
    
    // Initialize charts after content is loaded
    setTimeout(() => {
        initializeContactCharts();
    }, 100);
}

function renderChatbot(data) {
    const mainContent = document.querySelector('.main-content');
    const chatbotData = data.data;
    
    mainContent.innerHTML = `
        <div class="header">
            <div class="header-left">
                <h1>AI Chatbot Dashboard</h1>
                <div class="header-subtitle">Monitor, manage, and optimize your AI-powered chatbot system</div>
            </div>
            <div class="header-right">
                <button class="btn btn-primary" onclick="openChatbotConfig()">
                    <i class="fas fa-cog"></i> Configure Bot
                </button>
                <button class="btn btn-outline-primary" onclick="exportChatbotData()">
                    <i class="fas fa-download"></i> Export Data
                </button>
            </div>
        </div>

        <!-- Quick Actions Bar -->
        <div class="quick-actions">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="conversationSearch" placeholder="Search conversations...">
            </div>
            <div class="filter-group">
                <select id="statusFilter" class="filter-select">
                    <option value="">All Status</option>
                    <option value="active">Active</option>
                    <option value="completed">Completed</option>
                    <option value="escalated">Escalated</option>
                    <option value="failed">Failed</option>
                </select>
                <select id="intentFilter" class="filter-select">
                    <option value="">All Intents</option>
                    <option value="general">General Queries</option>
                    <option value="emergency">Emergency Cases</option>
                    <option value="support">Support</option>
                    <option value="billing">Billing</option>
                </select>
                <select id="timeFilter" class="filter-select">
                    <option value="today">Today</option>
                    <option value="week">This Week</option>
                    <option value="month">This Month</option>
                    <option value="quarter">This Quarter</option>
                </select>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ü§ñ</div>
                <div class="stat-label">Total Conversations</div>
                <div class="stat-value" id="totalConversations">${chatbotData.total_conversations}</div>
                <div class="stat-change stat-positive">‚Üó +15.3%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Today:</span>
                    <span class="stat-footer-value">156</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üí¨</div>
                <div class="stat-label">Active Sessions</div>
                <div class="stat-value" id="activeSessions">${chatbotData.active_sessions}</div>
                <div class="stat-change stat-positive">‚Üó +8.2%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Avg Duration:</span>
                    <span class="stat-footer-value">4.2 min</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚ö°</div>
                <div class="stat-label">Avg Response Time</div>
                <div class="stat-value" id="avgResponseTime">${chatbotData.avg_response_time}</div>
                <div class="stat-change stat-positive">‚Üì -25%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Target:</span>
                    <span class="stat-footer-value">1.0s</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üéØ</div>
                <div class="stat-label">Success Rate</div>
                <div class="stat-value" id="successRate">${chatbotData.success_rate}</div>
                <div class="stat-change stat-positive">‚Üó +2.1%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Escalations:</span>
                    <span class="stat-footer-value">5.8%</span>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Real-time Conversations -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Real-time Conversations</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshConversations()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="btn btn-link" onclick="toggleAutoRefresh()">
                            <i class="fas fa-play" id="autoRefreshIcon"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="conversations-list" id="conversationsList">
                        ${chatbotData.recent_conversations.map(conv => `
                            <div class="conversation-item ${conv.status}">
                                <div class="conversation-avatar">üë§</div>
                                <div class="conversation-content">
                                    <div class="conversation-header">
                                        <div class="conversation-user">${conv.user}</div>
                                        <div class="conversation-time">${conv.time}</div>
                                    </div>
                                    <div class="conversation-preview">${conv.preview}</div>
                                    <div class="conversation-meta">
                                        <span class="intent-badge ${conv.intent.toLowerCase().replace(/\s+/g, '-')}">${conv.intent}</span>
                                        <span class="status-badge ${conv.status}">${conv.status}</span>
                                    </div>
                                </div>
                                <div class="conversation-actions">
                                    <button class="action-btn" onclick="viewConversation('${conv.id}')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="joinConversation('${conv.id}')">
                                        <i class="fas fa-comments"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>

            <!-- Performance Analytics -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Performance Analytics</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshPerformance()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Intent Distribution -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Intent Distribution</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshIntents()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="intentChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- User Satisfaction -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>User Satisfaction</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshSatisfaction()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="satisfaction-metrics">
                        <div class="satisfaction-item">
                            <div class="satisfaction-icon positive">üòä</div>
                            <div class="satisfaction-info">
                                <div class="satisfaction-label">Positive</div>
                                <div class="satisfaction-value">${chatbotData.satisfaction.positive}%</div>
                                <div class="satisfaction-count">${chatbotData.satisfaction.positive_count} ratings</div>
                            </div>
                        </div>
                        <div class="satisfaction-item">
                            <div class="satisfaction-icon neutral">üòê</div>
                            <div class="satisfaction-info">
                                <div class="satisfaction-label">Neutral</div>
                                <div class="satisfaction-value">${chatbotData.satisfaction.neutral}%</div>
                                <div class="satisfaction-count">${chatbotData.satisfaction.neutral_count} ratings</div>
                            </div>
                        </div>
                        <div class="satisfaction-item">
                            <div class="satisfaction-icon negative">üòû</div>
                            <div class="satisfaction-info">
                                <div class="satisfaction-label">Negative</div>
                                <div class="satisfaction-value">${chatbotData.satisfaction.negative}%</div>
                                <div class="satisfaction-count">${chatbotData.satisfaction.negative_count} ratings</div>
                            </div>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="satisfactionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Training Data -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Training Data</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshTrainingData()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="btn btn-link" onclick="addTrainingData()">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="training-stats">
                        <div class="training-stat">
                            <div class="training-label">Total Intents</div>
                            <div class="training-value">${chatbotData.training.total_intents}</div>
                            <div class="training-change positive">+3 this week</div>
                        </div>
                        <div class="training-stat">
                            <div class="training-label">Training Phrases</div>
                            <div class="training-value">${chatbotData.training.training_phrases}</div>
                            <div class="training-change positive">+45 this week</div>
                        </div>
                        <div class="training-stat">
                            <div class="training-label">Response Templates</div>
                            <div class="training-value">${chatbotData.training.response_templates}</div>
                            <div class="training-change positive">+12 this week</div>
                        </div>
                    </div>
                    <div class="training-progress">
                        <div class="progress-item">
                            <div class="progress-label">Model Accuracy</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${chatbotData.training.model_accuracy}%"></div>
                            </div>
                            <div class="progress-value">${chatbotData.training.model_accuracy}%</div>
                        </div>
                        <div class="progress-item">
                            <div class="progress-label">Training Coverage</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${chatbotData.training.training_coverage}%"></div>
                            </div>
                            <div class="progress-value">${chatbotData.training.training_coverage}%</div>
                        </div>
                        <div class="progress-item">
                            <div class="progress-label">Fallback Rate</div>
                            <div class="progress-bar">
                                <div class="progress-fill negative" style="width: ${chatbotData.training.fallback_rate}%"></div>
                            </div>
                            <div class="progress-value">${chatbotData.training.fallback_rate}%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Recent Activity</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshActivity()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="activity-list">
                        ${chatbotData.recent_activity.map(activity => `
                            <div class="activity-item">
                                <div class="activity-icon">${activity.icon}</div>
                                <div class="activity-content">
                                    <div class="activity-title">${activity.title}</div>
                                    <div class="activity-description">${activity.description}</div>
                                    <div class="activity-time">${activity.time}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        </div>

        <!-- Conversations Table -->
        <div class="table-section">
            <div class="table-header">
                <h3>All Conversations</h3>
                <div class="table-actions">
                    <button class="btn btn-link" onclick="refreshTable()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <button class="btn btn-link" onclick="exportTable()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table" id="conversationsTable">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Intent</th>
                            <th>Status</th>
                            <th>Duration</th>
                            <th>Messages</th>
                            <th>Satisfaction</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${chatbotData.conversations_table.map(conv => `
                            <tr>
                                <td>${conv.user}</td>
                                <td><span class="intent-badge ${conv.intent.toLowerCase().replace(/\s+/g, '-')}">${conv.intent}</span></td>
                                <td><span class="status-badge ${conv.status}">${conv.status}</span></td>
                                <td>${conv.duration}</td>
                                <td>${conv.messages}</td>
                                <td>‚≠ê ${conv.satisfaction}</td>
                                <td>${conv.created}</td>
                                <td>
                                    <div class="table-actions">
                                        <button class="action-btn" onclick="viewConversation('${conv.id}')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn" onclick="joinConversation('${conv.id}')">
                                            <i class="fas fa-comments"></i>
                                        </button>
                                        <button class="action-btn" onclick="exportConversation('${conv.id}')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
            <div class="table-pagination">
                <button class="btn btn-link" onclick="previousPage()">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <span id="pageInfo">Page 1 of 8</span>
                <button class="btn btn-link" onclick="nextPage()">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    `;
    
    // Initialize charts after content is loaded
    setTimeout(() => {
        initializeChatbotCharts();
    }, 100);
}

function renderDocumentation(data) {
    const mainContent = document.querySelector('.main-content');
    const docData = data.data;
    
    mainContent.innerHTML = `
        <div class="header">
            <div class="header-left">
                <h1>Documentation Center</h1>
                <div class="header-subtitle">Comprehensive guides, API references, and troubleshooting resources</div>
            </div>
            <div class="header-right">
                <button class="btn btn-primary" onclick="openSearchModal()">
                    <i class="fas fa-search"></i> Search Documentation
                </button>
                <button class="btn btn-outline-primary" onclick="exportDocumentation()">
                    <i class="fas fa-download"></i> Export
                </button>
            </div>
        </div>

        <!-- Search and Quick Actions -->
        <div class="quick-actions">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="docSearch" placeholder="Search documentation, guides, APIs...">
                <button class="search-btn" onclick="performSearch()">
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
            <div class="filter-group">
                <select id="categoryFilter" class="filter-select">
                    <option value="">All Categories</option>
                    <option value="system">System Documentation</option>
                    <option value="user">User Guides</option>
                    <option value="api">API Reference</option>
                    <option value="reports">Reports & Analytics</option>
                    <option value="troubleshooting">Troubleshooting</option>
                </select>
                <select id="typeFilter" class="filter-select">
                    <option value="">All Types</option>
                    <option value="guide">Guides</option>
                    <option value="api">API Docs</option>
                    <option value="tutorial">Tutorials</option>
                    <option value="reference">References</option>
                </select>
                <select id="statusFilter" class="filter-select">
                    <option value="">All Status</option>
                    <option value="new">New</option>
                    <option value="updated">Recently Updated</option>
                    <option value="popular">Popular</option>
                </select>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üìö</div>
                <div class="stat-label">Total Documents</div>
                <div class="stat-value">${docData.total_documents}</div>
                <div class="stat-change stat-positive">‚Üó +12.5%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Last Updated:</span>
                    <span class="stat-footer-value">2 hours ago</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-label">Active Contributors</div>
                <div class="stat-value">${docData.active_contributors}</div>
                <div class="stat-change stat-positive">‚Üó +3</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">This Month:</span>
                    <span class="stat-footer-value">+5 new</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üëÅÔ∏è</div>
                <div class="stat-label">Total Views</div>
                <div class="stat-value">${docData.total_views.toLocaleString()}</div>
                <div class="stat-change stat-positive">‚Üó +8.3%</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Today:</span>
                    <span class="stat-footer-value">156 views</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚≠ê</div>
                <div class="stat-label">Average Rating</div>
                <div class="stat-value">${docData.average_rating}</div>
                <div class="stat-change stat-positive">‚Üó +0.2</div>
                <div class="stat-footer">
                    <span class="stat-footer-label">Reviews:</span>
                    <span class="stat-footer-value">342</span>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Documentation Categories -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Documentation Categories</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshCategories()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="category-grid">
                        ${docData.categories.map(category => `
                            <div class="category-item" onclick="filterByCategory('${category.name.toLowerCase().replace(/\s+/g, '-')}')">
                                <div class="category-icon">${getCategoryIcon(category.name)}</div>
                                <div class="category-info">
                                    <div class="category-title">${category.name}</div>
                                    <div class="category-count">${category.count} documents</div>
                                    <div class="category-description">${getCategoryDescription(category.name)}</div>
                                </div>
                                <div class="category-badge ${category.status}">${category.status}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>

            <!-- Recent Documents -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Recently Updated</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshRecentDocs()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="recent-docs-list">
                        ${docData.recent_documents.map(doc => `
                            <div class="doc-item">
                                <div class="doc-icon">${getDocIcon(doc.category)}</div>
                                <div class="doc-content">
                                    <div class="doc-title">${doc.title}</div>
                                    <div class="doc-meta">
                                        <span class="doc-category">${doc.category}</span>
                                        <span class="doc-updated">Updated ${doc.updated}</span>
                                    </div>
                                    <div class="doc-description">${getDocDescription(doc.title)}</div>
                                </div>
                                <div class="doc-actions">
                                    <button class="action-btn" onclick="viewDocument('${doc.title.toLowerCase().replace(/\s+/g, '-')}')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn" onclick="bookmarkDocument('${doc.title.toLowerCase().replace(/\s+/g, '-')}')">
                                        <i class="fas fa-bookmark"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>

            <!-- Popular Documents -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Most Popular</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshPopularDocs()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="popular-docs-list">
                        ${docData.popular_documents.map((doc, index) => `
                            <div class="popular-doc-item">
                                <div class="popular-doc-rank">${index + 1}</div>
                                <div class="popular-doc-content">
                                    <div class="popular-doc-title">${doc.title}</div>
                                    <div class="popular-doc-stats">
                                        <span class="views">${doc.views.toLocaleString()} views</span>
                                        <span class="rating">‚≠ê ${doc.rating}</span>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-outline-primary" onclick="viewDocument('${doc.title.toLowerCase().replace(/\s+/g, '-')}')">View</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>

            <!-- Documentation Analytics -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3>Documentation Analytics</h3>
                    <div class="card-actions">
                        <button class="btn btn-link" onclick="refreshAnalytics()">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="docAnalyticsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Initialize charts after content is loaded
    setTimeout(() => {
        initializeDocAnalyticsChart();
    }, 100);
}

// Helper functions for documentation
function getCategoryIcon(categoryName) {
    const icons = {
        'System Documentation': '‚öôÔ∏è',
        'User Guides': 'üë©‚Äçüíº',
        'API Reference': 'üîå',
        'Reports & Analytics': 'üìä',
        'Troubleshooting': 'üîß',
        'Tutorials': 'üéì'
    };
    return icons[categoryName] || 'üìö';
}

function getCategoryDescription(categoryName) {
    const descriptions = {
        'System Documentation': 'API guides, setup instructions, configuration',
        'User Guides': 'Role-based guides for all user types',
        'API Reference': 'Complete API documentation and examples',
        'Reports & Analytics': 'Reporting guides and analytics documentation',
        'Troubleshooting': 'Common issues and solutions',
        'Tutorials': 'Step-by-step learning guides'
    };
    return descriptions[categoryName] || 'Documentation and guides';
}

function getDocIcon(category) {
    const icons = {
        'User Guide': 'üìã',
        'API Reference': 'üîå',
        'Reports & Analytics': 'üìä',
        'Troubleshooting': 'üîß',
        'System': '‚öôÔ∏è'
    };
    return icons[category] || 'üìÑ';
}

function getDocDescription(title) {
    const descriptions = {
        'Getting Started with Call Management': 'Complete guide for new counselors on managing calls effectively',
        'API Authentication Guide': 'Comprehensive guide on API authentication methods and best practices',
        'Advanced Analytics Dashboard': 'Guide to using advanced analytics features and custom reports',
        'Troubleshooting Common Issues': 'Solutions for common system issues and error messages'
    };
    return descriptions[title] || 'Documentation and reference material';
}

// Function to initialize Chatbot charts
function initializeChatbotCharts() {
    // Performance Chart
    const performanceCtx = document.getElementById('performanceChart');
    if (performanceCtx) {
        new Chart(performanceCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [
                    {
                        label: 'Success Rate',
                        data: [89, 91, 93, 92, 94, 94.2],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Response Time (s)',
                        data: [1.5, 1.3, 1.1, 1.0, 0.9, 0.8],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true,
                        yAxisID: 'y1'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        }
                    },
                    y1: {
                        position: 'right',
                        beginAtZero: true,
                        max: 2,
                        grid: {
                            drawOnChartArea: false
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            }
        });
    }

    // Intent Distribution Chart
    const intentCtx = document.getElementById('intentChart');
    if (intentCtx) {
        new Chart(intentCtx, {
            type: 'doughnut',
            data: {
                labels: ['General Queries', 'Support', 'Emergency', 'Billing', 'Other'],
                datasets: [{
                    data: [45, 25, 15, 10, 5],
                    backgroundColor: [
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(239, 68, 68, 0.8)',
                        'rgba(245, 158, 11, 0.8)',
                        'rgba(107, 114, 128, 0.8)'
                    ],
                    borderColor: [
                        'rgba(59, 130, 246, 1)',
                        'rgba(16, 185, 129, 1)',
                        'rgba(239, 68, 68, 1)',
                        'rgba(245, 158, 11, 1)',
                        'rgba(107, 114, 128, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            usePointStyle: true,
                            padding: 20
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.raw || 0;
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${label}: ${value}% (${percentage}%)`;
                            }
                        }
                    }
                },
                cutout: '60%'
            }
        });
    }

    // Satisfaction Chart
    const satisfactionCtx = document.getElementById('satisfactionChart');
    if (satisfactionCtx) {
        new Chart(satisfactionCtx, {
            type: 'bar',
            data: {
                labels: ['1 Star', '2 Stars', '3 Stars', '4 Stars', '5 Stars'],
                datasets: [{
                    label: 'Ratings',
                    data: [42, 89, 156, 445, 789],
                    backgroundColor: [
                        'rgba(239, 68, 68, 0.8)',
                        'rgba(245, 158, 11, 0.8)',
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(34, 197, 94, 0.8)'
                    ],
                    borderColor: [
                        'rgba(239, 68, 68, 1)',
                        'rgba(245, 158, 11, 1)',
                        'rgba(59, 130, 246, 1)',
                        'rgba(16, 185, 129, 1)',
                        'rgba(34, 197, 94, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const value = context.raw || 0;
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${value} ratings (${percentage}%)`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
    }
}
</script>
