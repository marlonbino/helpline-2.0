<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketing Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard_styles.css') }}">

</head>
<body>
    <div class="dashboard">
        <div class="sidebar">
            <div class="logo">Helpline 2.0</div>
            
            <div class="nav-section">
                <div class="nav-title">Operations</div>
                <a href="#" class="nav-item active">
                    <div class="nav-icon">üìä</div>
                    <span>Dashboard</span>
                </a>
                <!-- Call Center Dropdown Start -->
                <a href="#callCenterSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <div class="nav-icon">üìû</div>
                    <span>Call Center</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </a>
                <div class="collapse" id="callCenterSubmenu">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a href="{{ url_for('calls_form') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìù</div>
                                <span>Form</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{{ url_for('calls_table') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìÑ</div>
                                <span>Table</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Call Center Dropdown End -->
                <!-- Cases Dropdown Start -->
                <a href="#casesSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <div class="nav-icon">üìÅ</div>
                    <span>Cases</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </a>
                <div class="collapse" id="casesSubmenu">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a href="{{ url_for('cases_form') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìù</div>
                                <span>Form</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{{ url_for('cases_table') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìÑ</div>
                                <span>Table</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Cases Dropdown End -->
                <!-- Calls Dropdown Start -->
                <a href="#callsSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <svg class="nav-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24c1.12.37 2.33.57 3.57.57c.55 0 1 .45 1 1V20c0 .55-.45 1-1 1c-9.39 0-17-7.61-17-17c0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1c0 1.25.2 2.45.57 3.57c.11.35.03.74-.25 1.02l-2.2 2.2z"></path></svg>
                    Calls
                </a>
                <div class="collapse" id="callsSubmenu">
                    <a href="{{ url_for('calls_form') }}" class="nav-item sub-item">
                        <svg class="nav-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg> Log New Call
                    </a>
                    <a href="{{ url_for('calls_table') }}" class="nav-item sub-item">
                        <svg class="nav-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M3 13h2v-2H3m0-4h2V7H3m0 8h2v-2H3m4 4h14v-2H7m0-4h14v-2H7m0-4h14V7H7v2Z"></path></svg> View Call Logs
                    </a>
                </div>
                <!-- Calls Dropdown End -->
                <a href="#" class="nav-item">
                    <div class="nav-icon">üìà</div>
                    <span>Reports</span>
                </a>
                <!-- Clients Dropdown Start -->
                <a href="#clientsSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <div class="nav-icon">üë•</div>
                    <span>Clients</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </a>
                <div class="collapse" id="clientsSubmenu">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a href="{{ url_for('clients_form') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìù</div>
                                <span>Form</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{{ url_for('clients_table') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìÑ</div>
                                <span>Table</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Clients Dropdown End -->
                <a href="#" class="nav-item">
                    <div class="nav-icon">üéØ</div>
                    <span>Interventions</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-title">Resources</div>
                <a href="#" class="nav-item">
                    <div class="nav-icon">üë®‚Äç‚öïÔ∏è</div>
                    <span>Counselors</span>
                </a>
                <a href="#" class="nav-item">
                    <div class="nav-icon">üìö</div>
                    <span>Resources</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-title">Administration</div>
                <!-- Users Dropdown Start -->
                <a href="#usersSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <div class="nav-icon">üë§</div>
                    <span>Users</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </a>
                <div class="collapse" id="usersSubmenu">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a href="{{ url_for('users_form') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìù</div>
                                <span>Form</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{{ url_for('users_table') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìÑ</div>
                                <span>Table</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Users Dropdown End -->
                <a href="#" class="nav-item">
                    <div class="nav-icon">üìã</div>
                    <span>Logs</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-title">System</div>
                <a href="#" class="nav-item">
                    <div class="nav-icon">‚öôÔ∏è</div>
                    <span>Settings</span>
                </a>
                <a href="#" class="nav-item">
                    <div class="nav-icon">üåô</div>
                    <span>Dark mode</span>
                </a>
            </div>

            <div class="profile-section">
                <div class="profile-avatar"></div>
                <div class="profile-info">
                    <div class="profile-name">Sarah Kinyua</div>
                    <div class="profile-status">Counselor</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            {% block page_content %}
            <div class="header">
                <h1>{{ title }}</h1>
                <div class="user-menu">
                    <span>Time period</span>
                    <span>‚ñº</span>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total calls received</div>
                    <div class="stat-value">2,847</div>
                    <div class="stat-change stat-positive">‚Üó +12.3%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active cases</div>
                    <div class="stat-value">156</div>
                    <div class="stat-change stat-positive">‚Üó +8.2%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Resolved cases</div>
                    <div class="stat-value">89</div>
                    <div class="stat-change stat-positive">‚Üó +15.4%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Children helped</div>
                    <div class="stat-value">423</div>
                    <div class="stat-change stat-positive">‚Üó +6.8%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Add data</div>
                    <div class="stat-value">+</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Call volume & Case trends</div>
                        <div class="chart-filters">
                            <button class="filter-btn">Daily calls</button>
                            <button class="filter-btn active">Weekly trends</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                    <div style="text-align: center; margin-top: 10px; font-size: 20px; font-weight: 600; color: #0f172a;">
                        387 calls <span style="font-size: 12px; color: #10b981;">‚Üó +18.2%</span>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Cases by category</div>
                    </div>
                    <div class="pie-chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Cases by county</div>
                    </div>
                    <div class="country-list">
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #dc2626;"></div>
                                Nairobi
                            </div>
                            <div class="country-percentage">28%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #ca8a04;"></div>
                                Kiambu
                            </div>
                            <div class="country-percentage">18%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #059669;"></div>
                                Mombasa
                            </div>
                            <div class="country-percentage">15%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #2563eb;"></div>
                                Nakuru
                            </div>
                            <div class="country-percentage">12%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #dc2626;"></div>
                                Kisumu
                            </div>
                            <div class="country-percentage">9%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #ca8a04;"></div>
                                Eldoret
                            </div>
                            <div class="country-percentage">8%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #2563eb;"></div>
                                Meru
                            </div>
                            <div class="country-percentage">6%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #059669;"></div>
                                Other
                            </div>
                            <div class="country-percentage">4%</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px;">
                        <div style="width: 60px; height: 40px; background: linear-gradient(135deg, #10b981, #3b82f6); border-radius: 8px; opacity: 0.8;"></div>
                    </div>
                </div>
            </div>
            {% endblock page_content %}
        </div>
    </div>

    <script>
        // Call Volume Chart
        const salesCtx = document.getElementById('salesChart').getContext('2d');
        new Chart(salesCtx, {
            type: 'bar',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7', 'Week 8', 'Week 9', 'Week 10', 'Week 11', 'Week 12'],
                datasets: [{
                    label: 'Calls',
                    data: [85, 92, 78, 95, 110, 88, 76, 120, 95, 105, 125, 135],
                    backgroundColor: '#3b82f6',
                    borderRadius: 4,
                    maxBarThickness: 30
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: { color: '#f1f5f9' },
                        ticks: { color: '#64748b', font: { size: 11 } }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: '#64748b', font: { size: 11 } }
                    }
                }
            }
        });

        // Case Category Chart
        const categoryCtx = document.getElementById('categoryChart').getContext('2d');
        new Chart(categoryCtx, {
            type: 'doughnut',
            data: {
                labels: ['Child Abuse', 'GBV Cases', 'Counseling', 'Family Issues', 'School Problems', 'Mental Health', 'Emergency', 'Other'],
                datasets: [{
                    data: [32, 24, 18, 12, 8, 3, 2, 1],
                    backgroundColor: [
                        '#ef4444',
                        '#f59e0b',
                        '#10b981',
                        '#3b82f6',
                        '#8b5cf6',
                        '#06b6d4',
                        '#84cc16',
                        '#64748b'
                    ],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                }
            }
        });

        // Add hover effects and interactions
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => { // Removed 'e' as it's not used, and e.preventDefault() is removed
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');
            });
        });

        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });
    </script>
    <!-- Bootstrap JS (for dropdowns/collapse) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>