<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketing Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #334155;
        }

        .dashboard {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 240px;
            background: white;
            border-right: 1px solid #e2e8f0;
            padding: 20px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            padding: 0 20px 30px;
            font-weight: 600;
            font-size: 18px;
        }

        .logo::before {
            content: "üõ°Ô∏è";
            margin-right: 8px;
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: #64748b;
            padding: 0 20px 10px;
            letter-spacing: 0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 8px 20px;
            color: #64748b;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s;
        }

        .nav-item:hover, .nav-item.active {
            background: #f1f5f9;
            color: #0f172a;
        }

        .nav-item.active {
            border-right: 2px solid #3b82f6;
        }

        .nav-icon {
            width: 16px;
            height: 16px;
            margin-right: 12px;
            opacity: 0.6;
        }

        .main-content {
            flex: 1;
            padding: 20px 30px;
            overflow-y: auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #0f172a;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .stat-label {
            font-size: 13px;
            color: #64748b;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 4px;
        }

        .stat-change {
            font-size: 12px;
            font-weight: 500;
        }

        .stat-positive { color: #10b981; }
        .stat-negative { color: #ef4444; }

        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #0f172a;
        }

        .chart-filters {
            display: flex;
            gap: 10px;
        }

        .filter-btn {
            padding: 4px 8px;
            font-size: 12px;
            border: none;
            background: #f1f5f9;
            color: #64748b;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-btn.active {
            background: #3b82f6;
            color: white;
        }

        .chart-container {
            position: relative;
            height: 250px;
        }

        .pie-chart-container {
            position: relative;
            height: 200px;
        }

        .country-list {
            margin-top: 15px;
        }

        .country-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .country-item:last-child {
            border-bottom: none;
        }

        .country-name {
            display: flex;
            align-items: center;
            font-size: 13px;
            color: #334155;
        }

        .country-flag {
            width: 16px;
            height: 12px;
            margin-right: 8px;
            border-radius: 2px;
            background: #e2e8f0;
        }

        .country-percentage {
            font-size: 13px;
            font-weight: 500;
            color: #0f172a;
        }

        .profile-section {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-top: 1px solid #e2e8f0;
            margin-top: auto;
        }

        .profile-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #3b82f6;
            margin-right: 10px;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 13px;
            font-weight: 500;
            color: #0f172a;
        }

        .profile-status {
            font-size: 11px;
            color: #64748b;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }
            
            .nav-item span, .nav-title, .profile-section {
                display: none;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }
            /* Dropdown specific styles */
        .sidebar .nav-item.dropdown-toggle {
            display: flex;
            align-items: center;
            width: 100%; /* Make the toggle take full width */
        }
        .sidebar .nav-item.dropdown-toggle .dropdown-arrow {
            margin-left: auto; /* Pushes arrow to the end */
            transition: transform 0.2s ease-in-out;
            font-size: 0.8em; /* Smaller arrow */
        }
        .sidebar .nav-item.dropdown-toggle[aria-expanded="true"] .dropdown-arrow {
            transform: rotate(180deg); /* Arrow points up when open */
        }
        .sidebar .collapse .nav.flex-column { /* Styling for the submenu container */
             padding-left: 10px; /* Indent the whole submenu slightly */
        }
        .sidebar .collapse .nav-link.sub-item {
            padding: 6px 20px 6px 15px; /* Top Right Bottom Left - More indent for sub-items */
            font-size: 13px;
            color: #64748b; /* Match main nav-item color */
            display: flex; /* Align icon and text */
            align-items: center; /* Align icon and text */
        }
        .sidebar .collapse .nav-link.sub-item:hover,
        .sidebar .collapse .nav-link.sub-item.active {
            background: #f1f5f9; /* Match main nav-item hover */
            color: #0f172a; /* Match main nav-item hover */
            border-right: none; /* Remove main active border for sub-items if not desired */
        }
        .sidebar .collapse .nav-link.sub-item.active {
             font-weight: 500; /* Make active sub-item slightly bolder */
        }
        .sidebar .collapse .nav-link.sub-item .nav-icon { /* Style for sub-item icons */
            width: 14px;
            height: 14px;
            margin-right: 10px; /* Space between sub-icon and text */
            opacity: 0.5;
        }
</style>
</head>
<body>
    <div class="dashboard">
        <div class="sidebar">
            <div class="logo">Helpline 2.0</div>
            
            <div class="nav-section">
                <div class="nav-title">Operations</div>
                <a href="#" class="nav-item active">
                    <div class="nav-icon">üìä</div>
                    <span>Dashboard</span>
                </a>
                <!-- Call Center Dropdown Start -->
                <a href="#callCenterSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <div class="nav-icon">üìû</div>
                    <span>Call Center</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </a>
                <div class="collapse" id="callCenterSubmenu">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a href="{{ url_for('calls_form') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìù</div>
                                <span>Form</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{{ url_for('calls_table') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìÑ</div>
                                <span>Table</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Call Center Dropdown End -->
                <!-- Cases Dropdown Start -->
                <a href="#casesSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <div class="nav-icon">üìÅ</div>
                    <span>Cases</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </a>
                <div class="collapse" id="casesSubmenu">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a href="{{ url_for('cases_form') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìù</div>
                                <span>Form</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{{ url_for('cases_table') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìÑ</div>
                                <span>Table</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Cases Dropdown End -->
                <!-- Calls Dropdown Start -->
                <a href="#callsSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <svg class="nav-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24c1.12.37 2.33.57 3.57.57c.55 0 1 .45 1 1V20c0 .55-.45 1-1 1c-9.39 0-17-7.61-17-17c0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1c0 1.25.2 2.45.57 3.57c.11.35.03.74-.25 1.02l-2.2 2.2z"></path></svg>
                    Calls
                </a>
                <div class="collapse" id="callsSubmenu">
                    <a href="{{ url_for('calls_form') }}" class="nav-item sub-item">
                        <svg class="nav-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg> Log New Call
                    </a>
                    <a href="{{ url_for('calls_table') }}" class="nav-item sub-item">
                        <svg class="nav-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M3 13h2v-2H3m0-4h2V7H3m0 8h2v-2H3m4 4h14v-2H7m0-4h14v-2H7m0-4h14V7H7v2Z"></path></svg> View Call Logs
                    </a>
                </div>
                <!-- Calls Dropdown End -->
                <a href="#" class="nav-item">
                    <div class="nav-icon">üìà</div>
                    <span>Reports</span>
                </a>
                <!-- Clients Dropdown Start -->
                <a href="#clientsSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <div class="nav-icon">üë•</div>
                    <span>Clients</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </a>
                <div class="collapse" id="clientsSubmenu">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a href="{{ url_for('clients_form') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìù</div>
                                <span>Form</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{{ url_for('clients_table') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìÑ</div>
                                <span>Table</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Clients Dropdown End -->
                <a href="#" class="nav-item">
                    <div class="nav-icon">üéØ</div>
                    <span>Interventions</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-title">Resources</div>
                <a href="#" class="nav-item">
                    <div class="nav-icon">üë®‚Äç‚öïÔ∏è</div>
                    <span>Counselors</span>
                </a>
                <a href="#" class="nav-item">
                    <div class="nav-icon">üìö</div>
                    <span>Resources</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-title">Administration</div>
                <!-- Users Dropdown Start -->
                <a href="#usersSubmenu" class="nav-item dropdown-toggle" data-bs-toggle="collapse" aria-expanded="false">
                    <div class="nav-icon">üë§</div>
                    <span>Users</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </a>
                <div class="collapse" id="usersSubmenu">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a href="{{ url_for('users_form') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìù</div>
                                <span>Form</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{{ url_for('users_table') }}" class="nav-link sub-item py-1">
                                <div class="nav-icon">üìÑ</div>
                                <span>Table</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- Users Dropdown End -->
                <a href="#" class="nav-item">
                    <div class="nav-icon">üìã</div>
                    <span>Logs</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-title">System</div>
                <a href="#" class="nav-item">
                    <div class="nav-icon">‚öôÔ∏è</div>
                    <span>Settings</span>
                </a>
                <a href="#" class="nav-item">
                    <div class="nav-icon">üåô</div>
                    <span>Dark mode</span>
                </a>
            </div>

            <div class="profile-section">
                <div class="profile-avatar"></div>
                <div class="profile-info">
                    <div class="profile-name">Sarah Kinyua</div>
                    <div class="profile-status">Counselor</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            {% block page_content %}
            <div class="header">
                <h1>{{ title }}</h1>
                <div class="user-menu">
                    <span>Time period</span>
                    <span>‚ñº</span>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total calls received</div>
                    <div class="stat-value">2,847</div>
                    <div class="stat-change stat-positive">‚Üó +12.3%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active cases</div>
                    <div class="stat-value">156</div>
                    <div class="stat-change stat-positive">‚Üó +8.2%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Resolved cases</div>
                    <div class="stat-value">89</div>
                    <div class="stat-change stat-positive">‚Üó +15.4%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Children helped</div>
                    <div class="stat-value">423</div>
                    <div class="stat-change stat-positive">‚Üó +6.8%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Add data</div>
                    <div class="stat-value">+</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Call volume & Case trends</div>
                        <div class="chart-filters">
                            <button class="filter-btn">Daily calls</button>
                            <button class="filter-btn active">Weekly trends</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                    <div style="text-align: center; margin-top: 10px; font-size: 20px; font-weight: 600; color: #0f172a;">
                        387 calls <span style="font-size: 12px; color: #10b981;">‚Üó +18.2%</span>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Cases by category</div>
                    </div>
                    <div class="pie-chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Cases by county</div>
                    </div>
                    <div class="country-list">
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #dc2626;"></div>
                                Nairobi
                            </div>
                            <div class="country-percentage">28%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #ca8a04;"></div>
                                Kiambu
                            </div>
                            <div class="country-percentage">18%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #059669;"></div>
                                Mombasa
                            </div>
                            <div class="country-percentage">15%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #2563eb;"></div>
                                Nakuru
                            </div>
                            <div class="country-percentage">12%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #dc2626;"></div>
                                Kisumu
                            </div>
                            <div class="country-percentage">9%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #ca8a04;"></div>
                                Eldoret
                            </div>
                            <div class="country-percentage">8%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #2563eb;"></div>
                                Meru
                            </div>
                            <div class="country-percentage">6%</div>
                        </div>
                        <div class="country-item">
                            <div class="country-name">
                                <div class="country-flag" style="background: #059669;"></div>
                                Other
                            </div>
                            <div class="country-percentage">4%</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px;">
                        <div style="width: 60px; height: 40px; background: linear-gradient(135deg, #10b981, #3b82f6); border-radius: 8px; opacity: 0.8;"></div>
                    </div>
                </div>
            </div>
            {% endblock page_content %}
        </div>
    </div>

    <script>
        // Call Volume Chart
        const salesCtx = document.getElementById('salesChart').getContext('2d');
        new Chart(salesCtx, {
            type: 'bar',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7', 'Week 8', 'Week 9', 'Week 10', 'Week 11', 'Week 12'],
                datasets: [{
                    label: 'Calls',
                    data: [85, 92, 78, 95, 110, 88, 76, 120, 95, 105, 125, 135],
                    backgroundColor: '#3b82f6',
                    borderRadius: 4,
                    maxBarThickness: 30
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: { color: '#f1f5f9' },
                        ticks: { color: '#64748b', font: { size: 11 } }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: '#64748b', font: { size: 11 } }
                    }
                }
            }
        });

        // Case Category Chart
        const categoryCtx = document.getElementById('categoryChart').getContext('2d');
        new Chart(categoryCtx, {
            type: 'doughnut',
            data: {
                labels: ['Child Abuse', 'GBV Cases', 'Counseling', 'Family Issues', 'School Problems', 'Mental Health', 'Emergency', 'Other'],
                datasets: [{
                    data: [32, 24, 18, 12, 8, 3, 2, 1],
                    backgroundColor: [
                        '#ef4444',
                        '#f59e0b',
                        '#10b981',
                        '#3b82f6',
                        '#8b5cf6',
                        '#06b6d4',
                        '#84cc16',
                        '#64748b'
                    ],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                }
            }
        });

        // Add hover effects and interactions
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => { // Removed 'e' as it's not used, and e.preventDefault() is removed
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');
            });
        });

        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });
    </script>
    <!-- Bootstrap JS (for dropdowns/collapse) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>